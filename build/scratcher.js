function Scratcher(){this.canvas=document.querySelector("canvas"),this.context=this.canvas.getContext("2d"),this.last={},this.init()}Scratcher.prototype.init=function(){this.width=300,this.height=200,this.layer(this.width,this.height),this.info(),this.listen()},Scratcher.prototype.info=function(){document.querySelector(".g-info").innerHTML="Can U see me?"},Scratcher.prototype.layer=function(t,e){var i=this.context;i.fillStyle="orange",i.fillRect(0,0,t,e),i.globalCompositeOperation="destination-out"},Scratcher.prototype.listen=function(){var t=this,e=!1,i=0,n=this.canvas,o=this.context,a="blue",r=48;n.addEventListener("touchstart",function(t){t.preventDefault(),e=!0,i=Date.now()}),n.addEventListener("touchend",function(i){i.preventDefault(),e=!1;for(var n=t.width,a=t.height,r=o.getImageData(0,0,n,a).data,s=0,h=0;s<r.length;s+=4)r[s]||r[s+1]||r[s+2]||r[s+3]||h++;h>=n*a*.8&&alert("well done")}),n.addEventListener("touchmove",function(o){if(o.preventDefault(),e||event.targetTouches){var s=o.targetTouches[0].clientX,h=o.targetTouches[0].clientY,c=n.getBoundingClientRect();s-=c.left*(n.width/c.width),h-=c.top*(n.height/c.height),s=parseInt(s),h=parseInt(h),t.move(s,h,a,r,i)}})},Scratcher.prototype.move=function(t,e,i,n,o){var a={x:t,y:e,color:i,size:n,sessionId:o};this.drawLine(a)},Scratcher.prototype.drawLine=function(t){var e=this.context;e.strokeStyle=t.color,e.fillStyle=t.color,e.lineWidth=t.size,e.lineCap="round",e.beginPath();var i=t.sessionId;this.last[i]?(e.moveTo(this.last[i].x,this.last[i].y),e.lineTo(t.x,t.y),e.stroke()):(e.moveTo(t.x,t.y),e.arc(t.x,t.y,t.size/2,0,2*Math.PI,!1),e.fill()),e.closePath(),this.last[i]=t},new Scratcher;